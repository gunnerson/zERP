{% extends "mtn/base.html" %}

<script>
  {% block jquery %}

    $("#sidebarBlock").hide();

    var pressList = document.querySelectorAll("rect");
    var pressIdList = [];
    var statusDict = {};
    var endpoint = "{% url 'equip:map-data' %}"

    for (i = 0; i < pressList.length; i++) {
      // press[i].addEventListener("click", pressOnClick);
      pressIdList.push(parseInt(pressList[i].getAttribute("press")));
    };

    $.ajax({
      method: "GET",
      url: endpoint,
      data: { 'pressIdList' : pressIdList,  },
      success: function(data){
        statusDict = data.statusDict
        updateStatus(statusDict)
      },
      error: function(error_data){
        console.log(error_data)
      }
    });

    function updateStatus(data){
      const object = data;
      for (const [key, value] of Object.entries(object)) {
        for (i = 0; i < pressList.length; i++) {
          if(pressList[i].getAttribute("press") == key){
            pressList[i].classList.add(value.toLowerCase().replace(/ /g,"_"));
          };
        };
      };
    };

   {% endblock %}
</script>

{% block left-menu %}{% endblock left-menu %}

{% block page-title %}

  <div class="page-title-right">
    <ol class="breadcrumb m-0">
        <li class="breadcrumb-item"><a href="{% url 'mtn:index' %}">Rahco</a></li>
        <li class="breadcrumb-item active">Map</li>
    </ol>
  </div>
  <h4 class="page-title">Floor map</h4>

{% endblock page-title %}

{% block content %}

  {% include 'equip/elements/map.svg'%}

{% endblock content %}



